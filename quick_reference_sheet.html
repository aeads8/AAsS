<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrew's Asynchronous System: Interactive System Guide</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Chart Container Styling Constraints */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* Constraint width */
            margin-left: auto;
            margin-right: auto;
            height: 40vh; /* Responsive height */
            max-height: 400px; /* Vertical constraint */
        }

        /* Custom Range Slider */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #4F46E5;
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #E5E7EB;
            border-radius: 99px;
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
    <!-- Chosen Palette: Slate (Neutrals), Indigo (Primary/Player), Rose (Tension/Harm), Emerald (Success) -->
    <!-- Application Structure Plan:
         1. Header: Title and core concept.
         2. Probability Lab: Interactive Chart.js section explaining the 3d6 curve. Users can slide a 'Modifier' to see how attributes affect success rates. This establishes the mathematical foundation.
         3. Attributes: A 4-column grid detailing the core stats (Body, Dex, Wit, Soul).
         4. Resource Economy: A split view (Player vs GM) detailing Momentum and Tension. Interactive toggles for spending costs.
         5. Harm Simulator: An interactive slider allowing users to add Damage Points and see the status/penalty update in real-time.
         6. Quick Reference Table: A synthesized view of roll outcomes.
         WHY: This flow moves from the abstract (math) to the concrete (stats), then to the flow of play (resources), and finally consequences (harm).
    -->
    <!-- Visualization & Content Choices:
         1. 3d6 Probability: Chart.js Bar Chart. Goal: Visualize the bell curve and "Critical" thresholds. Interaction: Modifier Slider.
         2. Harm Track: HTML Range Input + Dynamic DOM manipulation. Goal: Show the "Death Spiral" effect of penalties.
         3. Resource Cards: Grid layout with colored accents. Goal: Differentiate Player (Momentum) vs GM (Tension) tools.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Header / Hero -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-extrabold text-slate-900 tracking-tight">Andrew's Asynchronous System</h1>
            <nav class="hidden md:flex space-x-8 text-sm font-medium text-slate-500">
                <a href="#core-mechanic" class="hover:text-indigo-600 transition">Core Mechanic</a>
                <a href="#attributes" class="hover:text-indigo-600 transition">Attributes</a>
                <a href="#resources" class="hover:text-indigo-600 transition">Resources</a>
                <a href="#harm" class="hover:text-indigo-600 transition">Harm</a>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-16">

        <!-- SECTION 1: CORE MECHANIC & PROBABILITY -->
        <section id="core-mechanic" class="space-y-6">
            <div class="max-w-3xl">
                <h2 class="text-3xl font-bold text-slate-900">The Core Mechanic: 3d6 + Bonus</h2>
                <p class="mt-4 text-lg text-slate-600 leading-relaxed">
                    Andrew's Asynchronous System relies on a standard 3d6 bell curve.  Understanding the math is key to managing your resources.
                </p>
                <p class="mt-2 text-slate-600">
                    <strong>Interactive Demo:</strong> Adjust the "Total Modifier" below to see how Attributes (+0 to +3) and Harm Penalties shift your probability of success.
                </p>
            </div>

            <!-- Visualization: Probability Chart -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                <div class="flex flex-col md:flex-row gap-8 items-center">
                    <!-- Controls -->
                    <div class="w-full md:w-1/3 space-y-6 bg-slate-50 p-6 rounded-xl border border-slate-100">
                        <div>
                            <label for="modifierSlider" class="block text-sm font-bold text-slate-700 mb-2">Total Modifier: <span id="modValue" class="text-indigo-600">+0</span></label>
                            <input type="range" id="modifierSlider" min="-5" max="8" value="0" step="1">
                            <div class="flex justify-between text-xs text-slate-400 mt-1">
                                <span>-5 (Debuffed)</span>
                                <span>+0</span>
                                <span>+8 (Maxed)</span>
                            </div>
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="font-medium text-emerald-600">Critical Success (15+):</span>
                                <span id="prob-crit" class="font-bold">9.3%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-medium text-green-600">Full Success (11-14):</span>
                                <span id="prob-full" class="font-bold">40.7%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-medium text-amber-600">Mixed Success (7-10):</span>
                                <span id="prob-mixed" class="font-bold">40.7%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-medium text-rose-600">Crit Failure (6-):</span>
                                <span id="prob-fail" class="font-bold">9.3%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Chart -->
                    <div class="w-full md:w-2/3">
                        <div class="chart-container">
                            <canvas id="probabilityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: ATTRIBUTES -->
        <section id="attributes" class="space-y-6">
            <div class="max-w-3xl">
                <h2 class="text-3xl font-bold text-slate-900">Character Attributes</h2>
                <p class="mt-4 text-lg text-slate-600">
                    Characters are defined by four core attributes.  These bonuses are added directly to your 3d6 roll.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Body -->
                <div class="bg-white p-6 rounded-xl border-t-4 border-indigo-500 shadow-sm card-hover transition duration-300">
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Body</h3>
                    <p class="text-slate-600 text-sm">Raw strength, endurance, carrying capacity, and brawling.</p>
                    <div class="mt-4 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800">
                        Physical
                    </div>
                </div>
                <!-- Dexterity -->
                <div class="bg-white p-6 rounded-xl border-t-4 border-cyan-500 shadow-sm card-hover transition duration-300">
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Dexterity</h3>
                    <p class="text-slate-600 text-sm">Agility, stealth, dodging, lock-picking, and precise actions.</p>
                    <div class="mt-4 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-cyan-100 text-cyan-800">
                        Finesse
                    </div>
                </div>
                <!-- Wit -->
                <div class="bg-white p-6 rounded-xl border-t-4 border-amber-500 shadow-sm card-hover transition duration-300">
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Wit</h3>
                    <p class="text-slate-600 text-sm">Mental challenges, investigating, deceiving, analyzing, and planning.</p>
                    <div class="mt-4 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800">
                        Mental
                    </div>
                </div>
                <!-- Soul -->
                <div class="bg-white p-6 rounded-xl border-t-4 border-purple-500 shadow-sm card-hover transition duration-300">
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Soul</h3>
                    <p class="text-slate-600 text-sm">Spiritual, social, and emotional challenges, persuasion, inspiration, and resisting fear.</p>
                    <div class="mt-4 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                        Social
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: RESOURCES (MOMENTUM vs TENSION) -->
        <section id="resources" class="space-y-6">
            <div class="max-w-3xl">
                <h2 class="text-3xl font-bold text-slate-900">The Resource Economy</h2>
                <p class="mt-4 text-lg text-slate-600">
                    Players earn <strong>Momentum</strong> through success to perform heroic feats. The Game Master accrues <strong>Tension</strong> through player failures or certain choices.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Player: Momentum -->
                <div class="bg-indigo-50 rounded-2xl p-8 border border-indigo-100">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-extrabold text-indigo-900">Momentum</h3>
                        <span class="px-3 py-1 bg-indigo-200 text-indigo-800 text-xs font-bold rounded-full uppercase">Player Resource</span>
                    </div>
                    
                    <div class="space-y-6">
                        <div>
                            <h4 class="font-bold text-indigo-800 mb-2 uppercase text-xs tracking-wider">How to Gain</h4>
                            <ul class="space-y-2 text-sm text-indigo-900">
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">●</span> <strong>Start of Game:</strong> Begin with 1 Momentum.</li>
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">●</span> <strong>Full Success (11-14):</strong> Gain +1 Momentum.</li>
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">●</span> <strong>Critical Success (15+):</strong> Gain +2 Momentum.</li>
                            </ul>
                        </div>

                        <div>
                            <h4 class="font-bold text-indigo-800 mb-2 uppercase text-xs tracking-wider">How to Spend</h4>
                            <div class="grid gap-3">
                                <div class="bg-white p-3 rounded-lg shadow-sm border border-indigo-100">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-bold text-indigo-700">Add Bonus</span>
                                        <span class="text-xs font-bold bg-indigo-100 text-indigo-600 px-2 py-1 rounded">Cost: 1</span>
                                    </div>
                                    <p class="text-xs text-slate-600">Add +2 to any Skill Check <em>before</em> rolling.</p>
                                </div>
                                <div class="bg-white p-3 rounded-lg shadow-sm border border-indigo-100">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-bold text-indigo-700">Re-Roll</span>
                                        <span class="text-xs font-bold bg-indigo-100 text-indigo-600 px-2 py-1 rounded">Cost: 2</span>
                                    </div>
                                    <p class="text-xs text-slate-600">Re-roll any result. You must accept the new result.</p>
                                </div>
                                <div class="bg-white p-3 rounded-lg shadow-sm border border-indigo-100">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-bold text-indigo-700">Declare Fact</span>
                                        <span class="text-xs font-bold bg-indigo-100 text-indigo-600 px-2 py-1 rounded">Cost: 3</span>
                                    </div>
                                    <p class="text-xs text-slate-600">Define a minor, helpful fact about the scene.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- GM: Tension -->
                <div class="bg-rose-50 rounded-2xl p-8 border border-rose-100">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-extrabold text-rose-900">Tension</h3>
                        <span class="px-3 py-1 bg-rose-200 text-rose-800 text-xs font-bold rounded-full uppercase">GM Resource</span>
                    </div>
                    
                    <div class="space-y-6">
                        <div>
                            <h4 class="font-bold text-rose-800 mb-2 uppercase text-xs tracking-wider">How to Gain</h4>
                            <ul class="space-y-2 text-sm text-rose-900">
                                <li class="flex items-start"><span class="mr-2 text-rose-500">●</span> <strong>Start of Game:</strong> Begin with 0 Tension.</li>
                                <li class="flex items-start"><span class="mr-2 text-rose-500">●</span> <strong>Mixed Success (7-10):</strong> GM gains +1 Tension.</li>
                                <li class="flex items-start"><span class="mr-2 text-rose-500">●</span> <strong>Critical Failure (6-):</strong> GM gains +2 Tension.</li>
                            </ul>
                        </div>

                        <div>
                            <h4 class="font-bold text-rose-800 mb-2 uppercase text-xs tracking-wider">How to Spend (GM)</h4>
                            <div class="grid gap-3">
                                <div class="bg-white p-3 rounded-lg shadow-sm border border-rose-100">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-bold text-rose-700">Complication</span>
                                        <span class="text-xs font-bold bg-rose-100 text-rose-600 px-2 py-1 rounded">Cost: 1</span>
                                    </div>
                                    <p class="text-xs text-slate-600">Introduce a minor enemy, small hazard, or degrade a Full Success to Mixed.</p>
                                </div>
                                <div class="bg-white p-3 rounded-lg shadow-sm border border-rose-100">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-bold text-rose-700">Escalate</span>
                                        <span class="text-xs font-bold bg-rose-100 text-rose-600 px-2 py-1 rounded">Cost: 2</span>
                                    </div>
                                    <p class="text-xs text-slate-600">Force an immediate, unexpected Skill Check or remove 1 Player Momentum.</p>
                                </div>
                                <div class="bg-white p-3 rounded-lg shadow-sm border border-rose-100">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-bold text-rose-700">Shift Scene</span>
                                        <span class="text-xs font-bold bg-rose-100 text-rose-600 px-2 py-1 rounded">Cost: 3</span>
                                    </div>
                                    <p class="text-xs text-slate-600">Radically shift the environment to the PCs' disadvantage.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: HARM -->
        <section id="harm" class="space-y-6">
            <div class="max-w-3xl">
                <h2 class="text-3xl font-bold text-slate-900">Harm & Damage</h2>
                <p class="mt-4 text-lg text-slate-600">
                    Characters have a limited capacity for damage. As <strong>Damage Points (DP)</strong> accumulate, penalties increase. Reaching 5 DP incapacitates a character.
                </p>
                <p class="mt-2 text-slate-600">
                    <strong>Interact:</strong> Slide the bar below to simulate taking damage and see the mechanical penalties.
                </p>
            </div>

            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <div class="flex justify-between items-end mb-2">
                        <label for="harmSlider" class="text-sm font-bold uppercase text-slate-500">Damage Points Accumulated</label>
                        <span id="dpValue" class="text-4xl font-extrabold text-slate-900">0</span>
                    </div>
                    <input type="range" id="harmSlider" min="0" max="6" value="0" step="1">
                    <div class="flex justify-between text-xs text-slate-400 mt-2 font-mono">
                        <span>0</span><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6+</span>
                    </div>
                </div>

                <div id="statusCard" class="bg-emerald-50 border-l-4 border-emerald-500 p-6 rounded-r-lg transition-colors duration-300">
                    <div class="flex flex-col md:flex-row justify-between md:items-center">
                        <div>
                            <h3 id="statusTitle" class="text-2xl font-bold text-emerald-800">Healthy</h3>
                            <p id="statusDesc" class="text-emerald-700 mt-1">You are fit and ready for action.</p>
                        </div>
                        <div class="mt-4 md:mt-0 text-right">
                            <span class="block text-xs font-bold uppercase text-emerald-600 opacity-70">Penalty</span>
                            <span id="statusPenalty" class="text-3xl font-mono font-bold text-emerald-800">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-slate-500">
                    <div class="bg-slate-50 p-3 rounded">
                        <strong>Rest:</strong> A full night's rest removes 1 DP.
                    </div>
                    <div class="bg-slate-50 p-3 rounded">
                        <strong>Aid:</strong> Successful ally check (Diff 11+) removes 1 DP.
                    </div>
                    <div class="bg-slate-50 p-3 rounded">
                        <strong>Stabilize:</strong> Broken characters need a Diff 15 medical check.
                    </div>
                </div>
            </div>
        </section>

        <!-- Summary Table -->
        <section class="border-t border-slate-200 pt-10">
            <h2 class="text-xl font-bold text-slate-900 mb-6">Quick Reference: Outcomes</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-200 bg-white rounded-lg shadow-sm border border-slate-200">
                    <thead class="bg-slate-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Roll Total</th>
                            <th class="px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Outcome</th>
                            <th class="px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Narrative Effect</th>
                            <th class="px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Resource Change</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-200">
                        <tr class="bg-emerald-50">
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-emerald-900">15+</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-emerald-700">Critical Success</td>
                            <td class="px-6 py-4 text-sm text-slate-600">Spectacular success.</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-emerald-700">+2 Momentum</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-green-700">11-14</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-green-700">Full Success</td>
                            <td class="px-6 py-4 text-sm text-slate-600">Complete and clean success.</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-green-700">+1 Momentum</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-amber-700">7-10</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-amber-700">Mixed Success</td>
                            <td class="px-6 py-4 text-sm text-slate-600">Success at a cost or complication.</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-rose-700">GM +1 Tension</td>
                        </tr>
                        <tr class="bg-rose-50">
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-rose-900">6-</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-rose-700">Critical Failure</td>
                            <td class="px-6 py-4 text-sm text-slate-600">Disastrous failure. Situation worsens.</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-rose-700">GM +2 Tension</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

    </main>

    <footer class="bg-slate-900 text-slate-400 py-12 mt-20">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p>&copy; Andrew's Asynchronous System RPG System.</p>
        </div>
    </footer>

    <script>
        // --- 1. Probability Chart Logic ---
        const ctx = document.getElementById('probabilityChart').getContext('2d');
        const modifierSlider = document.getElementById('modifierSlider');
        const modValueDisplay = document.getElementById('modValue');
        
        // Probability displays
        const dispCrit = document.getElementById('prob-crit');
        const dispFull = document.getElementById('prob-full');
        const dispMixed = document.getElementById('prob-mixed');
        const dispFail = document.getElementById('prob-fail');

        // 3d6 Frequency Map (Sum -> Count)
        const frequency = {
            3: 1, 4: 3, 5: 6, 6: 10, 7: 15, 8: 21, 9: 25, 10: 27,
            11: 27, 12: 25, 13: 21, 14: 15, 15: 10, 16: 6, 17: 3, 18: 1
        };
        const totalCombinations = 216;

        function calculateProbabilities(modifier) {
            let counts = { fail: 0, mixed: 0, full: 0, crit: 0 };
            
            for (let roll = 3; roll <= 18; roll++) {
                let result = roll + modifier;
                let count = frequency[roll];
                
                if (result <= 6) counts.fail += count;
                else if (result <= 10) counts.mixed += count;
                else if (result <= 14) counts.full += count;
                else counts.crit += count;
            }
            return counts;
        }

        function updateChart(modifier) {
            const counts = calculateProbabilities(modifier);
            
            // Update Text Displays
            dispFail.textContent = ((counts.fail / totalCombinations) * 100).toFixed(1) + "%";
            dispMixed.textContent = ((counts.mixed / totalCombinations) * 100).toFixed(1) + "%";
            dispFull.textContent = ((counts.full / totalCombinations) * 100).toFixed(1) + "%";
            dispCrit.textContent = ((counts.crit / totalCombinations) * 100).toFixed(1) + "%";

            // Update Chart Data
            chart.data.datasets[0].data = [
                (counts.fail / totalCombinations) * 100,
                (counts.mixed / totalCombinations) * 100,
                (counts.full / totalCombinations) * 100,
                (counts.crit / totalCombinations) * 100
            ];
            chart.update();
        }

        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Crit Fail (6-)', 'Mixed (7-10)', 'Full (11-14)', 'Crit Success (15+)'],
                datasets: [{
                    label: 'Probability %',
                    data: [0,0,0,0], // Initial dummy data, updated immediately
                    backgroundColor: [
                        'rgba(225, 29, 72, 0.7)',  // Rose-600
                        'rgba(217, 119, 6, 0.7)',  // Amber-600
                        'rgba(22, 163, 74, 0.7)',  // Green-600
                        'rgba(16, 185, 129, 0.7)'  // Emerald-500
                    ],
                    borderRadius: 6,
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.parsed.y.toFixed(1) + '%';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: { callback: (val) => val + '%' },
                        grid: { display: true, color: '#f1f5f9' }
                    },
                    x: {
                        grid: { display: false }
                    }
                }
            }
        });

        // Init Chart
        updateChart(0);

        // Event Listener for Modifier Slider
        modifierSlider.addEventListener('input', (e) => {
            const val = parseInt(e.target.value);
            const sign = val >= 0 ? '+' : '';
            modValueDisplay.innerText = `${sign}${val}`;
            updateChart(val);
        });


        // --- 2. Harm Slider Logic ---
        const harmSlider = document.getElementById('harmSlider');
        const dpValue = document.getElementById('dpValue');
        const statusCard = document.getElementById('statusCard');
        const statusTitle = document.getElementById('statusTitle');
        const statusDesc = document.getElementById('statusDesc');
        const statusPenalty = document.getElementById('statusPenalty');

        // Definitions for states
        const harmStates = [
            { // 0
                title: "Healthy", 
                desc: "No penalties. You are fit and ready.", 
                penalty: "0", 
                colorClass: "emerald", 
                borderColor: "border-emerald-500", 
                bgColor: "bg-emerald-50",
                textTitle: "text-emerald-800",
                textDesc: "text-emerald-700",
                textPen: "text-emerald-800"
            },
            { // 1
                title: "Bruised (Minor)", 
                desc: "Minor scrapes and winded.", 
                penalty: "-1", 
                colorClass: "amber", 
                borderColor: "border-amber-500", 
                bgColor: "bg-amber-50",
                textTitle: "text-amber-800",
                textDesc: "text-amber-700",
                textPen: "text-amber-800"
            },
            { // 2
                title: "Bruised (Minor)", 
                desc: "Minor scrapes and winded.", 
                penalty: "-1", 
                colorClass: "amber", 
                borderColor: "border-amber-500", 
                bgColor: "bg-amber-50",
                textTitle: "text-amber-800",
                textDesc: "text-amber-700",
                textPen: "text-amber-800"
            },
            { // 3
                title: "Injured (Moderate)", 
                desc: "Serious wounds or deep fatigue.", 
                penalty: "-2", 
                colorClass: "orange", 
                borderColor: "border-orange-500", 
                bgColor: "bg-orange-50",
                textTitle: "text-orange-800",
                textDesc: "text-orange-700",
                textPen: "text-orange-800"
            },
            { // 4
                title: "Injured (Moderate)", 
                desc: "Serious wounds or deep fatigue.", 
                penalty: "-2", 
                colorClass: "orange", 
                borderColor: "border-orange-500", 
                bgColor: "bg-orange-50",
                textTitle: "text-orange-800",
                textDesc: "text-orange-700",
                textPen: "text-orange-800"
            },
            { // 5
                title: "Broken (Critical)", 
                desc: "Incapacitated. Out of the fight.", 
                penalty: "X", 
                colorClass: "slate", 
                borderColor: "border-slate-600", 
                bgColor: "bg-slate-200",
                textTitle: "text-slate-800",
                textDesc: "text-slate-700",
                textPen: "text-slate-900"
            }
        ];

        harmSlider.addEventListener('input', (e) => {
            const val = parseInt(e.target.value);
            dpValue.innerText = val >= 5 ? "5+" : val;
            
            // Determine state index (0=0, 1-2=Bruised, 3-4=Injured, 5+=Broken)
            let state;
            if (val === 0) state = harmStates[0];
            else if (val <= 2) state = harmStates[1]; // Handles 1, 2
            else if (val <= 4) state = harmStates[3]; // Handles 3, 4
            else state = harmStates[5]; // Handles 5, 6+

            // Update DOM
            statusTitle.innerText = state.title;
            statusDesc.innerText = state.desc;
            statusPenalty.innerText = state.penalty;

            // Reset classes
            statusCard.className = `p-6 rounded-r-lg border-l-4 transition-colors duration-300 ${state.bgColor} ${state.borderColor}`;
            
            statusTitle.className = `text-2xl font-bold ${state.textTitle}`;
            statusDesc.className = `mt-1 ${state.textDesc}`;
            statusPenalty.className = `text-3xl font-mono font-bold ${state.textPen}`;
        });

    </script>
</body>
</html>
